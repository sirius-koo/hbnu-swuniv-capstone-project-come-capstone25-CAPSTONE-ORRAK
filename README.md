# 한밭대학교 컴퓨터공학과 ORRAK
**초보 클라이머를 위한 자세 추정 기반 분석 도구**

**팀 구성**
- 20201047 구남석

## <u>Teamate</u> Project Background
- **분석 도구의 필요성**
  - 초보 클라이머는 지도 없이 자신의 자세가 올바른지 판단하기 어렵고, 잘못된 자세로 인해 부상 위험이 높다.
  - 기존 영상 기록이나 단순 피드백으로는 무게 중심, 삼지점 유지 여부 등 객관적인 자세 데이터를 확인하기 어렵다.
  - 따라서, **사용자가 스스로 자세 분석 영상을 보고 올바른 자세로 완등할 수 있도록 지원하는 도구**가 필요하다.

- **기존 해결책의 문제점**
  - 기존 전문가 코칭은 비용과 시간 측면에서 접근성이 낮아, 모든 초보자가 지속적으로 받기 어렵다.
  - 단순 영상 피드백이나 지시 중심의 코칭은 사용자가 **왜 해당 자세를 취해야 하는지**, **무게 중심과 삼지점 유지가 갖는 의미**를 직관적으로 이해하기 어렵다.  
    따라서, 사용자가 영상을 보고 스스로 루트 파인딩과 자세 교정 능력을 기르는 데 한계가 있다.
  
## System Design
- **녹화 영상 분석**: 사용자가 벽을 올라가는 동안 촬영된 영상을 기반으로, 관절 좌표와 무게 중심을 계산한다.
- **직관적 피드백 UI**: 영상 위에 관절 위치, 안정/불안정 상태, 무게 중심점 위치, 삼지점 유지 여부를 색상과 표시로 시각화한다.  

## Analysis Process
<img src="Images/sample5.png" width="500" height="500">

### 무게 중심(COS, Center Of Mass) 계산
- 각 신체 세그먼트(상완, 전완, 대퇴, 경골 등)의 질량 비율을 고려하여 **세그먼트 중심 좌표**를 구한다.
- 전체 무게 중심은 각 세그먼트 중심과 질량을 가중 평균하여 계산한다:

$\[
\text{COM} = \frac{\sum_i (\text{Segment COM}_i \times \text{mass ratio}_i)}{\sum_i \text{mass ratio}_i}
\]$

### 기저면(BOS, Base of Support) 계산

- **정의**  
  기저면(Base of Support, BOS)은 클라이머의 신체가 벽과 접촉하는 지점(손, 발 등)이 만드는 **지지 다각형 영역**이다.  
  이 영역은 클라이머가 안정적으로 자세를 유지할 수 있는 공간을 의미하며,  
  무게 중심(COM)이 이 영역 안에 존재할 때 자세가 안정적이라 판단한다.

- **BOS 계산 과정**
  1. Mediapipe로 검출된 신체 관절 중 `left_wrist`, `right_wrist`, `left_ankle`, `right_ankle` 좌표를 추출한다.  
  2. 현재 프레임에서 벽과 접촉 중인 손·발을 식별하고, 그 중 3개 지점의 (x, y) 좌표를 선택한다.  
  3. 선택된 세 점의 좌표를 이용해 **삼각형(또는 사각형) 기저면**을 정의한다.  
  4. 다각형 내부 포함 여부를 통해 무게 중심(COM)의 위치를 판단한다.  

### 관절 각도 계산
- 사용자의 팔꿈치, 어깨, 손목 등 주요 관절 좌표를 Mediapipe로 추출한다.
- 관절 각도는 벡터 연산으로 계산하며, 예를 들어 팔꿈치 각도는 아래와 같이 구한다:

$\[
\text{Angle} = \arccos \left( \frac{(A-B) \cdot (C-B)}{\|A-B\| \|C-B\|} \right)
\]$

- 여기서 \(A, B, C\)는 각각 상완, 팔꿈치, 전완 위치를 의미.

- COM, BOS 위치는 영상에 표시되며, 삼지점(손과 발)으로 이루어진 사각형 내에 COM이 유지되는지 여부를 색상으로 표시한다.  

### Description
- 사용자가 벽을 오르는 동안 카메라로 촬영된 영상을 입력하면, Mediapipe 기반 포즈 추정으로 주요 관절 좌표를 추출한다.
- 무게 중심(COM)을 추정하여 삼지점 사각형 내 유지 여부를 색상으로 표시하고, 안정적인 자세와 불안정한 자세를 구분한다.
- 분석된 영상은 OpenCV로 처리되어 프레임별 피드백이 포함된 최종 결과물을 제공한다.
- 본 분석은 다이나믹한 빠른 동작보다는 **스태틱 클라이밍**을 대상으로 하며, 자세 교정과 안정성 확인에 초점을 맞춘다.  
  
## Conclusion
- 본 프로젝트는 초보 클라이머가 지도 없이도 자신의 자세를 객관적으로 평가하고 개선할 수 있는 피드백 도구를 제공한다.
- 관절 각도 계산과 무게 중심(COM) 분석을 통해 **=삼지점 유지 및 안정성**을 직관적으로 확인할 수 있으며, 올바른 자세로 완등할 수 있도록 한다.

---
# UI 

# 사용 시나리오

